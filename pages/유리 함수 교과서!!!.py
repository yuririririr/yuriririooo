import streamlit as st
import math

# ----------------------------
# 🌈 전체 스타일 (배경 + 폰트 + 버튼)
# ----------------------------
st.markdown("""
<style>
body {
    background: linear-gradient(135deg, #E3F2FD 0%, #FFFFFF 100%);
    font-family: 'Noto Sans KR', sans-serif;
    color: #0D47A1;
}
section.main > div {
    background: rgba(255,255,255,0.92);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(33,150,243,0.15);
}
h1, h2, h3 {
    color: #1565C0;
}
.stButton button {
    background-color: #1565C0;
    color: white;
    border-radius: 8px;
    font-weight: bold;
}
.stButton button:hover {
    background-color: #0D47A1;
}
table {
    background-color: #F6FAFF;
    border-collapse: collapse;
    width: 100%;
    border-radius: 8px;
}
table th, table td {
    border: 1px solid #E3F2FD;
    padding: 8px;
    text-align: center;
}
</style>
""", unsafe_allow_html=True)

# ----------------------------
# 📘 표지
# ----------------------------
st.markdown("<h1 style='text-align:center;'>📘 공통수학Ⅱ - 유리함수 교과서</h1>", unsafe_allow_html=True)
st.markdown("<h4 style='text-align:center;'>개념부터 실생활까지 완전 정복!</h4>", unsafe_allow_html=True)
st.info("이 교과서는 공통수학Ⅱ 교과 내용을 바탕으로 유리함수를 쉽게 이해할 수 있도록 구성되었습니다. "
        "각 소단원은 개념 → 예시 → 실생활 → 퀴즈 순서로 학습할 수 있습니다.")

# ----------------------------
# 1️⃣ 유리함수의 뜻
# ----------------------------
st.header("1️⃣ 유리함수의 뜻")
st.write("""
**유리함수**란 ‘분모에 문자가 포함된 함수’를 말합니다.  
좀 더 정확히 말하면, **분자와 분모가 모두 다항식**으로 이루어진 함수입니다.

\\[
f(x) = \\frac{P(x)}{Q(x)}, \\quad Q(x) \\neq 0
\\]

즉, 분모가 0이 되는 곳에서는 0으로 나눌 수 없기 때문에 함수값이 존재하지 않습니다.  
따라서 유리함수의 **정의역**은 ‘분모를 0으로 만드는 x값을 제외한 모든 실수’입니다.
""")

st.info("예시) \\( f(x) = \\frac{x+1}{x-2} \\) 는 x=2에서 정의되지 않습니다. → 정의역: 모든 실수 중 2 제외")

# 확인 퀴즈 1
st.subheader("🧠 확인 퀴즈 1")
q1 = st.radio(
    "다음 중 유리함수의 정의로 알맞은 것은?",
    [
        "① 분자가 상수이고 분모가 문자이다.",
        "② 분자와 분모가 모두 다항식이다.",
        "③ 분모가 0이 되어도 상관없는 함수이다.",
        "④ 로그함수를 포함한 모든 함수이다."
    ],
    index=None
)
if q1:
    if q1.startswith("②"):
        st.success("✅ 정답! 유리함수는 분자와 분모가 모두 다항식인 함수입니다.")
    else:
        st.error("❌ 오답이에요. 분자와 분모가 모두 다항식이어야 합니다.")

# ----------------------------
# 2️⃣ 기본형 유리함수의 그래프
# ----------------------------
st.header("2️⃣ 기본형 유리함수의 그래프")
st.write("""
가장 기본적인 유리함수는 \\( y = \\frac{k}{x} \\)입니다.  
이 함수는 다음과 같은 성질을 가집니다:

- **x=0**에서는 정의되지 않습니다 → 수직점근선 x=0  
- **x가 커질수록 (또는 작아질수록)**, y는 0에 가까워집니다 → 수평점근선 y=0
- 그래프는 원점을 중심으로 점대칭입니다.
""")

st.markdown("""
| 구분 | k > 0 | k < 0 |
|------|--------|--------|
| 그래프 위치 | 1사분면과 3사분면 | 2사분면과 4사분면 |
| 대칭성 | 원점 대칭 | 원점 대칭 |
| 점근선 | x=0, y=0 | x=0, y=0 |
""")

st.warning("💡 점근선은 ‘그래프가 가까워지지만 닿지 않는 직선’이에요. 즉, 무한히 접근하지만 만나지 않습니다.")

# 확인 퀴즈 2
st.subheader("🧠 확인 퀴즈 2")
q2 = st.radio(
    "y = k/x에서 k가 음수일 때 그래프는 어디에 위치하나요?",
    [
        "① 1사분면과 3사분면",
        "② 2사분면과 4사분면",
        "③ 1사분면과 2사분면",
        "④ 3사분면과 4사분면"
    ],
    index=None
)
if q2:
    if q2.startswith("②"):
        st.success("✅ 정답! k<0이면 그래프는 2사분면과 4사분면에 있습니다.")
    else:
        st.error("❌ 오답이에요. k가 음수면 y값도 반대 방향으로 이동합니다.")

# ----------------------------
# 3️⃣ 유리함수의 그래프 이동
# ----------------------------
st.header("3️⃣ 유리함수의 그래프 이동")
st.write("""
유리함수는 x축과 y축 방향으로 이동할 수 있습니다.  
기본형 \\( y = \\frac{k}{x} \\)를 다음과 같이 바꾸면 이동된 그래프가 됩니다.

\\[
y = \\frac{k}{x - a} + b
\\]

- (x - a)는 그래프를 **오른쪽으로 a만큼 이동**
- +b는 그래프를 **위로 b만큼 이동**
- 수직점근선: x=a
- 수평점근선: y=b
- 중심점: (a, b)
""")

st.markdown("""
| 항목 | 의미 | 점근선 |
|------|------|---------|
| a | 그래프를 오른쪽으로 a만큼 이동 | x = a |
| b | 그래프를 위로 b만큼 이동 | y = b |
""")

# 확인 퀴즈 3
st.subheader("🧠 확인 퀴즈 3")
q3 = st.radio(
    "y = 2/(x-3) + 1 의 수직점근선과 수평점근선은?",
    [
        "① x=3, y=1",
        "② x=-3, y=-1",
        "③ x=0, y=0",
        "④ x=-3, y=1"
    ],
    index=None
)
if q3:
    if q3.startswith("①"):
        st.success("✅ 정답! x=3, y=1 이 점근선이에요.")
    else:
        st.error("❌ 오답이에요. (x-3)은 오른쪽으로 3, +1은 위로 1 이동입니다.")

# ----------------------------
# 4️⃣ 유리함수의 성질 요약
# ----------------------------
st.header("4️⃣ 유리함수의 성질 정리")
st.markdown("""
| 항목 | 내용 |
|------|------|
| 정의 | 분자·분모 모두 다항식 |
| 정의역 | 분모를 0으로 만드는 값 제외 |
| 점근선 | 수직: x=a, 수평: y=b |
| 대칭성 | (a,b)를 중심으로 점대칭 |
| 부호 | k>0 → 1·3사분면, k<0 → 2·4사분면 |
""")

# ----------------------------
# 5️⃣ 유리함수의 실생활 활용
# ----------------------------
st.header("5️⃣ 유리함수의 실생활 활용")
st.write("""
유리함수는 단순히 그래프를 그리는 데 그치지 않고, **실생활의 역비례 관계**를 표현하는 데 매우 자주 등장합니다.  
아래는 실제 교과서에서 소개할 수 있는 대표적인 예시들입니다.
""")

st.markdown("""
### ⚙️ ① 속도와 이동 시간의 관계
거리 D가 일정할 때, 이동 시간은 다음 식으로 표현됩니다.
\\[
t = \\frac{D}{v}
\\]
- 속도 v가 커질수록 시간 t는 줄어듭니다.  
→ **역비례 관계**, 즉 유리함수의 대표적 예시입니다.
""")

st.markdown("""
### 🔌 ② 전류와 저항의 관계 (옴의 법칙)
\\[
I = \\frac{V}{R}
\\]
- 전압(V)은 일정하다고 하면, 저항(R)이 커질수록 전류(I)는 작아집니다.  
→ 전류와 저항은 유리함수 관계입니다.
""")

st.markdown("""
### ☕ ③ 농도 희석
용질의 양 S가 일정할 때, 전체 부피가 커지면 농도는 다음과 같이 변합니다.
\\[
C = \\frac{S}{V_0 + x}
\\]
- 물을 더 넣을수록 농도가 희석됩니다.  
→ 분모가 커지면 전체값이 작아지는 유리함수의 특징입니다.
""")

st.markdown("""
### 🔭 ④ 렌즈의 초점거리 공식
\\[
\\frac{1}{f} = \\frac{1}{u} + \\frac{1}{v} \\Rightarrow v = \\frac{fu}{u - f}
\\]
- 물체가 초점에 가까워질수록 상의 위치(v)는 급격히 멀어집니다.  
→ u에 대한 유리함수 관계입니다.
""")

st.markdown("""
### 💰 ⑤ 생산량과 평균비용
총비용이 일정할 때, 생산량이 많아질수록 평균비용은 줄어듭니다.
\\[
평균비용 = \\frac{총비용}{생산량}
\\]
- 생산량이 많아질수록 1개당 비용이 줄어드는 것은 역비례 관계입니다.
""")

# 실생활 퀴즈
st.subheader("🧠 실생활 퀴즈")
q4 = st.radio(
    "다음 중 유리함수 관계가 아닌 것은?",
    [
        "① 속도와 이동 시간",
        "② 전류와 저항",
        "③ 생산량과 평균비용",
        "④ 시간과 온도 상승량"
    ],
    index=None
)
if q4:
    if q4.startswith("④"):
        st.success("✅ 정답! 시간과 온도 상승은 일반적으로 정비례 관계입니다.")
    else:
        st.error("❌ 오답이에요. 시간과 온도는 보통 정비례 관계예요.")

# ----------------------------
# 6️⃣ 단원 마무리
# ----------------------------
st.header("6️⃣ 단원 마무리 요약")
st.markdown("""
| 항목 | 핵심 내용 |
|------|------------|
| 정의 | 분자와 분모가 모두 다항식 |
| 정의역 | 분모=0인 x는 제외 |
| 그래프 | 점근선 x=a, y=b |
| 대칭 | (a,b) 점대칭 |
| 실생활 예시 | 속도-시간, 전류-저항, 농도, 렌즈, 평균비용 |
""")

st.success("🎓 유리함수는 ‘나눗셈 관계’를 수학적으로 표현한 함수입니다. "
           "속도, 전류, 농도 등 실생활 속 수많은 현상이 유리함수의 원리를 따릅니다.")
st.balloons()
