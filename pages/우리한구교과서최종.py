import streamlit as st

st.set_page_config(page_title="유리함수 교과서", page_icon="📘", layout="centered")

st.title("📘 유리함수 교과서 (고1용)")
st.write("유리함수를 직관적으로 이해하고, 예제를 풀고, 직접 그래프 성질까지 확인해보는 인터랙티브 교재입니다.")

st.divider()

# 사이드바
st.sidebar.title("단원 이동")
section = st.sidebar.radio(
    "보고 싶은 단원을 선택하세요:",
    [
        "1. 유리함수의 정의",
        "2. 그래프와 점근선",
        "3. 함수값 계산 연습",
        "4. 핵심 정리 노트",
        "5. 연습 문제",
        "6. 체크 퀴즈",
        "7. 오늘 배운 내용 정리",
    ],
)

# 1. 유리함수의 정의
if section == "1. 유리함수의 정의":
    st.header("1️⃣ 유리함수란 무엇인가?")
    st.write(
        """
**유리함수(rational function)** 는 분수처럼 생긴 함수인데,  
**분자와 분모가 모두 다항식인 함수**를 말해.

예를 들어

\\[
f(x) = \\frac{x+1}{x-2}, \quad
g(x) = \\frac{2x^2 - 3}{x^2 + x - 6}
\\]

이런 애들은 다 유리함수야.

---

### ✋ 중요한 포인트
- 분모(아래)가 0이 되는 x 값에서는 함수가 정의되지 않아.  
  이유: 수학에서 0으로 나누는 건 불가능하기 때문이야.
- 그래서 그런 x 값에서는 그래프가 '뚝 끊겨' 버려.

예를 들어  
\\( f(x) = \\frac{x+1}{x-2} \\) 에서  
분모 = x - 2  
→ 분모 = 0 이 되려면 x = 2  
→ 즉 **x = 2에서는 f(x)가 존재하지 않는다 (정의 안 됨).**

이게 진짜 중요해. 시험에서 맨날 나와.
"""
    )

    st.subheader("용어 정리")
    st.write(
        """
- **정의역(domain)**: 함수에 넣어도 되는 x 값들의 집합  
  (0으로 나누는 x는 빼고 생각해야 함)
- **유리함수의 형태**:  
  \\( \\displaystyle f(x) = \\frac{P(x)}{Q(x)} \\)  
  여기서 \\( P(x), Q(x) \\) 는 다항식이고, \\( Q(x) \\neq 0 \\)

- 예: \\( \\frac{2x-5}{x+3} \\) ✅ 유리함수  
- 예: \\( \\sqrt{x+1} \\) ❌ 유리함수 아님 (분수 형태가 아님)
"""
    )

# 2. 그래프와 점근선
elif section == "2. 그래프와 점근선":
    st.header("2️⃣ 유리함수 그래프의 특징 (점근선)")
    st.write(
        """
유리함수 그래프는 보통 ‘얇은 하트 두 조각’ 같은 모양이 나오고, 중간에 선을 넘지 못하는 부분이 있어.  
그 ‘넘지 못하는 선’을 **점근선(asymptote, 점~근~선)** 이라고 불러.

점근선은 두 종류가 있어:

---

### 1. 수직 점근선 (vertical asymptote)
- 분모가 0이 되는 x 값에서 생김.
- 예: \\( f(x) = \\frac{x+1}{x-2} \\) 에서는  
  분모가 0이 되는 x = 2 에서 그래프가 끊겨.  
  그래서 **x = 2 가 수직 점근선**.

즉, 그래프가 x = 2 라는 세로선에 가까이 가긴 하는데 절대 닿지는 못해.

---

### 2. 수평 점근선 (horizontal asymptote)
- x가 엄청 크거나(멀리 오른쪽), 엄청 작아질 때(멀리 왼쪽) 그래프가 다가가는 y 값.
- 예: \\( f(x) = \\frac{x+1}{x-2} \\) 에서는  
  x가 엄청 커지면, f(x)는 대충 \\( \\frac{x}{x} = 1 \\) 근처로 가.
  그래서 **y = 1 이 수평 점근선**이야.

---

정리하면,
- 수직 점근선 → 분모 = 0 되는 x 값
- 수평 점근선 → x → 매우 크거나 매우 작을 때의 y 값
"""
    )

    st.info("시험에서 '점근선의 방정식을 쓰시오' 라고 하면 x=뭐, y=뭐 이런 식으로 선의 식을 적는 거야.")

    st.subheader("시각 예시 (참고용 이미지)")
    st.write("유리함수 그래프 예시: 꺾여 있고, 세로선/가로선 근처만 따라감.")
    st.image(
        "https://i.imgur.com/jgYoL0L.png",
        caption="f(x) = (x+1)/(x-2) 의 전형적인 모양 (수직 점근선 x=2, 수평 점근선 y=1 비슷한 형태)",
    )

# 3. 함수값 계산 연습
elif section == "3. 함수값 계산 연습":
    st.header("3️⃣ 직접 값 계산해보기")
    st.write(
        """
연습할 함수:
\\[
f(x) = \\frac{x+1}{x-2}
\\]

x 값을 슬라이더로 바꿔 보면서 f(x)가 어떻게 변하는지,  
그리고 x=2 근처에서 갑자기 막 튀는지 확인해봐.
"""
    )

    x = st.slider("x 값을 골라봐 (x=2는 정의 안 됨)", -10, 10, 0)

    if x == 2:
        y = "정의되지 않음 (0으로 나눔)"
    else:
        y = (x + 1) / (x - 2)

    st.write(f"f({x}) = (x + 1) / (x - 2) = {y}")

    st.write(
        """
👉 만약 '정의되지 않음'이 나왔다면 그건 x=2라서 분모가 0이기 때문이야.  
이건 '그 x값은 이 함수의 정의역에 포함 안 돼' 라는 뜻이야.
"""
    )

    st.subheader("정의역(Domain) 확인해보기")
    st.write(
        """
이 함수의 정의역은 '모든 실수 중에서 x=2만 제외'라고 할 수 있어.

- 수학 기호로 쓰면:  \\( \\mathbb{R} \\setminus \\{2\\} \\)
- 말로 쓰면:  2만 빼고 다 돼요
"""
    )

# 4. 핵심 정리 노트
elif section == "4. 핵심 정리 노트":
    st.header("4️⃣ 핵심 정리 (시험용 핵심 문장만 쏙쏙)")
    st.write(
        """
**[1] 유리함수의 정의**  
유리함수는 \\( f(x) = \\frac{P(x)}{Q(x)} \\) 꼴 (P와 Q는 다항식, Q(x) ≠ 0).  
즉 분수처럼 생겼고, 아래(분모)에 x가 있음.  

**[2] 정의역**  
분모를 0으로 만드는 x 값은 넣으면 안 된다 → 그 x는 정의역에서 제외.

**[3] 수직 점근선**  
분모 = 0 이 되는 x = a 이면, x = a 가 수직 점근선이 될 가능성이 매우 높다.  
(보통은 그대로 맞음. 단, 약분으로 없어지는 경우는 예외인데 그건 고1에서는 잘 안 낸다.)

**[4] 수평 점근선**  
x → 매우 크게 가면(∞ 방향) 함수값이 일정한 y 값에 가까워질 수 있는데,  
그 y = k 가 수평 점근선 y = k.

예:  
\\( f(x) = \\frac{x+1}{x-2} \\) 은 x가 커질수록 y=1 근처로 감 → 수평 점근선 y=1.
"""
    )

    st.success("외우면 좋은 말: '분모 0 되는 x → 수직 점근선 / 멀리 가면 다가가는 y → 수평 점근선'")

# 5. 연습 문제
elif section == "5. 연습 문제":
    st.header("5️⃣ 연습 문제")

    st.subheader("문제 1. 정의역 구하기")
    st.write(
        """
함수 \\( f(x) = \\frac{2x-5}{x+3} \\) 의 정의역을 구하시오.

(힌트: 분모가 0이 되는 x만 제외하면 됨)
"""
    )

    answer1 = st.text_input("정의역을 말로 적어봐. 예: '모든 실수 중에서 x = ? 제외'")

    if answer1:
        st.write("네 답:", answer1)
        st.info("정답: 모든 실수 중에서 x = -3 제외. 이유: x+3=0 → x=-3에서 0으로 나누게 되므로 사용 불가.")

    st.divider()

    st.subheader("문제 2. 수직 점근선")
    st.write(
        """
함수 \\( g(x) = \\frac{x^2 - 1}{x - 4} \\) 의 수직 점근선의 방정식을 구하시오.
"""
    )

    q2 = st.text_input("수직 점근선은 x = ? 형태로 적어봐", key="q2")

    if q2:
        st.write("네 답:", q2)
        st.info("정답: x = 4.  (분모 x-4=0 → x=4에서 그래프가 끊어져서 세로 점근선이 됨)")

    st.divider()

    st.subheader("문제 3. 수평 점근선(조금 응용)")
    st.write(
        r"""
함수 \( h(x) = \frac{x+2}{x-1} \) 에서  
x가 엄청 커질 때(즉 x → ∞), h(x)는 어떤 y값으로 가까워질까요?

그 y = k 라고 하면, 수평 점근선은 y = k 입니다.  
k는 얼마일까요?
"""
    )

    q3 = st.text_input("k = ?", key="q3")

    if q3:
        st.write("네 답:", q3)
        st.info("정답: y = 1.  (큰 x에 대해서 (x+2)/(x-1) ≈ x/x = 1 이라서 y=1로 접근해요.)")

# 6. 체크 퀴즈 (OX/객관식 느낌)
elif section == "6. 체크 퀴즈":
    st.header("6️⃣ 너 이해했는지 체크하는 미니퀴즈")

    st.write("퀴즈 1. 아래 중 유리함수인 것은?")
    q1 = st.radio(
        "하나만 고르세요",
        [
            "① f(x) = (x^2 + 1) / (x - 3)",
            "② f(x) = √(x + 5)",
            "③ f(x) = |x|",
        ],
        index=None,
    )

    if q1 is not None:
        st.write("너의 선택:", q1)
        st.info("정답: ①. 분수 형태이고 분자/분모가 다항식. √나 절댓값만 있는 건 유리함수가 아님.")

    st.divider()

    st.write("퀴즈 2. 수직 점근선은 언제 생기는가?")
    q2 = st.radio(
        "가장 알맞은 설명은?",
        [
            "A. 분자가 0이 되는 x 값에서",
            "B. 분모가 0이 되는 x 값에서",
            "C. y가 0이 되는 지점에서",
        ],
        index=None,
        key="quiz2",
    )

    if q2 is not None:
        st.write("너의 선택:", q2)
        st.info("정답: B. 분모=0이 되는 x 값에서 그래프가 끊어지고 거기가 수직 점근선이 돼.")

    st.divider()

    st.write("퀴즈 3. f(x) = (x+1)/(x-2) 의 수평 점근선은?")
    q3 = st.radio(
        "하나 고르기",
        [
            "a. x = 2",
            "b. y = 1",
            "c. y = 2",
        ],
        index=None,
        key="quiz3",
    )

    if q3 is not None:
        st.write("너의 선택:", q3)
        st.info("정답: b. x가 커질수록 (x+1)/(x-2)는 1에 가까워지므로 y=1.")

# 7. 오늘 배운 내용 정리 (메모)
elif section == "7. 오늘 배운 내용 정리":
    st.header("7️⃣ 오늘 배운 내용 정리")
    st.write(
        """
이 칸은 네 공부기록/세특(학교 생활기록부)용으로 쓸 수 있는 공간이야.
오늘 유리함수 공부한 걸 네 말로 정리해 봐.  
'뭘 알게 됐는지' + '어느 부분이 어려웠는지' 까지 적으면 완전 좋아.
"""
    )

    memo = st.text_area("오늘 공부한 걸 정리해보세요 (예: '유리함수에서 분모=0이면 정의X라는 걸 이해했다' 등)")
    if memo.strip() != "":
        st.write("✍ 네 정리:")
        st.success(memo)

st.divider()
st.caption("만든이: 나 ( + GPT-5 Thinking 보조 )  |  과목: 수학 (유리함수 단원)")
